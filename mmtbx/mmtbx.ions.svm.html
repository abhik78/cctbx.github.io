<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>mmtbx.ions.svm package &mdash; CCTBX None documentation</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     'None',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="CCTBX None documentation" href="../index.html" />
    <link rel="up" title="mmtbx.ions package" href="mmtbx.ions.html" />
    <link rel="next" title="mmtbx.ions.svm.dump_sites module" href="mmtbx.ions.svm.dump_sites.html" />
    <link rel="prev" title="mmtbx.ions package" href="mmtbx.ions.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="mmtbx.ions.svm.dump_sites.html" title="mmtbx.ions.svm.dump_sites module"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="mmtbx.ions.html" title="mmtbx.ions package"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">CCTBX None documentation</a> &raquo;</li>
          <li><a href="mmtbx.html" >mmtbx - macromolecular crystallography</a> &raquo;</li>
          <li><a href="mmtbx.ions.html" accesskey="U">mmtbx.ions package</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="mmtbx-ions-svm-package">
<h1>mmtbx.ions.svm package<a class="headerlink" href="#mmtbx-ions-svm-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="mmtbx.ions.svm.dump_sites.html">mmtbx.ions.svm.dump_sites module</a></li>
<li class="toctree-l1"><a class="reference internal" href="mmtbx.ions.svm.utils.html">mmtbx.ions.svm.utils module</a></li>
</ul>
</div>
</div>
<div class="section" id="module-mmtbx.ions.svm">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-mmtbx.ions.svm" title="Permalink to this headline">¶</a></h2>
<p>A set of functions to act upon ChemicalEnvironment and ScatteringEnvironment and
produce a single class and vector of features for use with a classifier.</p>
<p>This module relies on a SVM classifier generated by the module within
phenix_dev.ion_identification.nader_ml. See that module&#8217;s description for more
details.</p>
<div class="section" id="see-also">
<h3>See Also<a class="headerlink" href="#see-also" title="Permalink to this headline">¶</a></h3>
<p>phenix_dev.ion_identification.nader_ml</p>
<dl class="function">
<dt id="mmtbx.ions.svm.ion_anomalous_vector">
<tt class="descclassname">mmtbx.ions.svm.</tt><tt class="descname">ion_anomalous_vector</tt><big>(</big><em>scatter_env</em>, <em>elements=None</em>, <em>ratios=True</em>, <em>anom_peak=False</em><big>)</big><a class="headerlink" href="#mmtbx.ions.svm.ion_anomalous_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a vector of the anomalous features of a site. These can either include
the f&#8217;&#8217; / f&#8217;&#8216;_expected for a variety of ion identities or the exact anomalous
peak height.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>scatter_env</strong> : mmtbx.ions.environment.ScatteringEnvironment</p>
<blockquote>
<div><p>An object containing information about the scattering environment at a
site.</p>
</div></blockquote>
<p><strong>elements</strong> : list of str, optional</p>
<blockquote>
<div><p>List of elements to include when calculating f&#8217;&#8216;_expected values. If
unset, takes the list from mmtbx.ions.ALLOWED_IONS.</p>
</div></blockquote>
<p><strong>ratios</strong> : bool, optional</p>
<blockquote>
<div><p>If False, instead of calculating ratios, just return a vector of the
wavelength, f&#8217;, and f&#8217;&#8216;.</p>
</div></blockquote>
<p><strong>anom_peak</strong> : bool, optional</p>
<blockquote>
<div><p>Whether to use the actual height of the anomalous map instead of the
calculated f&#8217;&#8217; values.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">numpy.array of float</p>
<blockquote class="last">
<div><p>A vector containing quantitative properties for classification.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="mmtbx.ions.svm.ion_class">
<tt class="descclassname">mmtbx.ions.svm.</tt><tt class="descname">ion_class</tt><big>(</big><em>chem_env</em><big>)</big><a class="headerlink" href="#mmtbx.ions.svm.ion_class" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the class name associated with the ion, analogous to the chemical
ID.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>chem_env</strong> : mmtbx.ions.environment.ChemicalEnvironment</p>
<blockquote>
<div><p>The object to extract the ion class from.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">str</p>
<blockquote class="last">
<div><p>The class associated with the ion (i.e. &#8220;HOH&#8221; or &#8220;ZN&#8221;).</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="mmtbx.ions.svm.ion_electron_density_vector">
<tt class="descclassname">mmtbx.ions.svm.</tt><tt class="descname">ion_electron_density_vector</tt><big>(</big><em>scatter_env</em>, <em>b_iso=False</em>, <em>occ=False</em>, <em>diff_peak=False</em><big>)</big><a class="headerlink" href="#mmtbx.ions.svm.ion_electron_density_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a vector containing information about the electron density around
the site. Currently this only includes the site&#8217;s peak in the 2FoFc map. May
be expanded in the future to include information about the volume of density
around the site.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>scatter_env</strong> : mmtbx.ions.environment.ScatteringEnvironment</p>
<blockquote>
<div><p>An object containing information about the scattering environment at a
site.</p>
</div></blockquote>
<p><strong>b_iso</strong> : bool, optional</p>
<blockquote>
<div><p>Include the atom&#8217;s refined isotropic b-factor, divided by the mean
b-factor of solvent molecules in the structure.</p>
</div></blockquote>
<p><strong>occ</strong> : bool, optional</p>
<blockquote>
<div><p>Include the atom&#8217;s refined occupancy.</p>
</div></blockquote>
<p><strong>diff_peak</strong> : bool, optional</p>
<blockquote>
<div><p>Include the difference map peak height.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">numpy.array of float</p>
<blockquote class="last">
<div><p>A vector containing quantitative properties for classification.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="mmtbx.ions.svm.ion_geometry_vector">
<tt class="descclassname">mmtbx.ions.svm.</tt><tt class="descname">ion_geometry_vector</tt><big>(</big><em>chem_env</em>, <em>geometry_names=None</em><big>)</big><a class="headerlink" href="#mmtbx.ions.svm.ion_geometry_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a vector for a site&#8217;s geometry. For each geometry in geometry_names
the vector contains a 1 if that geometry is present at the site and 0
otherwise.</p>
<p>A single boolean was chosen after some trial and error with an SVM as
differences in deviations &lt; 15 degrees were not found to be significant in
helping to diffentiate ions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>chem_env</strong> : mmtbx.ions.environment.ChemicalEnvironment</p>
<blockquote>
<div><p>A object containing information about the chemical environment at a site.</p>
</div></blockquote>
<p><strong>geometry_names</strong> : list of str, optional</p>
<blockquote>
<div><p>A list of geometry names to check for. If unset, take names from
mmtbx.ions.SUPPORTED_GEOMETRY_NAMES.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">numpy.array of float</p>
<blockquote class="last">
<div><p>A vector containing quantitative properties for classification.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="mmtbx.ions.svm.ion_model_vector">
<tt class="descclassname">mmtbx.ions.svm.</tt><tt class="descname">ion_model_vector</tt><big>(</big><em>scatter_env</em>, <em>d_min=True</em>, <em>nearest_res=0.5</em><big>)</big><a class="headerlink" href="#mmtbx.ions.svm.ion_model_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a vector containing information about the general properties of the
model in which the site is found. Currently this only includes the minimum
resolution of the data set.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>scatter_env</strong> : mmtbx.ions.environment.ScatteringEnvironment</p>
<blockquote>
<div><p>An object containing information about the scattering environment at a
site.</p>
</div></blockquote>
<p><strong>d_min</strong> : bool, optional</p>
<blockquote>
<div><p>Include the high resolution associated with the model as a feature.</p>
</div></blockquote>
<p><strong>nearest_res</strong> : float, optional</p>
<blockquote>
<div><p>If not None, the nearest value to round d_min to. This value has no effect
if nearest_res is False.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">numpy.array of float</p>
<blockquote class="last">
<div><p>A vector containing quantitative properties for classification.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="mmtbx.ions.svm.ion_nearby_atoms_vector">
<tt class="descclassname">mmtbx.ions.svm.</tt><tt class="descname">ion_nearby_atoms_vector</tt><big>(</big><em>chem_env</em>, <em>environments=None</em><big>)</big><a class="headerlink" href="#mmtbx.ions.svm.ion_nearby_atoms_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a vector for the identities of the ions surrounding a site. Returns
a vector with a count of coordinating nitrogens, oxygens, sulfurs, and
chlorines.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>chem_env</strong> : mmtbx.ions.environment.ChemicalEnvironment</p>
<blockquote>
<div><p>A object containing information about the chemical environment at a site.</p>
</div></blockquote>
<p><strong>environments</strong> : list of int, optional</p>
<blockquote>
<div><p>A list of environments to check for. If unset, takes values from
mmtbx.ions.environment.N_SUPPORTED_ENVIRONMENTS.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">numpy.array of float</p>
<blockquote class="last">
<div><p>A vector containing quantitative properties for classification.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="mmtbx.ions.svm.ion_valence_vector">
<tt class="descclassname">mmtbx.ions.svm.</tt><tt class="descname">ion_valence_vector</tt><big>(</big><em>chem_env</em>, <em>elements=None</em><big>)</big><a class="headerlink" href="#mmtbx.ions.svm.ion_valence_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the BVS and VECSUM values for a variety of ion identities.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>chem_env</strong> : mmtbx.ions.environment.ChemicalEnvironment</p>
<blockquote>
<div><p>A object containing information about the chemical environment at a site.</p>
</div></blockquote>
<p><strong>elements</strong> : list of str, optional</p>
<blockquote>
<div><p>List of elements to include when calculating BVS and VECSUM values. If
unset, takes the list from mmtbx.ions.ALLOWED_IONS.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">numpy.array of float</p>
<blockquote class="last">
<div><p>A vector containing quantitative properties for classification.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="mmtbx.ions.svm.ion_vector">
<tt class="descclassname">mmtbx.ions.svm.</tt><tt class="descname">ion_vector</tt><big>(</big><em>chem_env</em>, <em>scatter_env</em>, <em>use_scatter=True</em>, <em>use_chem=True</em>, <em>b_iso=True</em>, <em>occ=True</em>, <em>diff_peak=True</em>, <em>geometry=True</em>, <em>elements=None</em>, <em>valence=True</em>, <em>anom=True</em>, <em>ratios=True</em>, <em>anom_peak=False</em>, <em>d_min=True</em><big>)</big><a class="headerlink" href="#mmtbx.ions.svm.ion_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a vector containing all of the useful properties contained
within ion. Merges together the vectors from ion_*_vector().</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>chem_env</strong> : mmtbx.ions.environment.ChemicalEnvironment</p>
<blockquote>
<div><p>A object containing information about the chemical environment at a site.</p>
</div></blockquote>
<p><strong>scatter_env</strong> : mmtbx.ions.environment.ScatteringEnvironment, optional</p>
<blockquote>
<div><p>An object containing information about the scattering environment at a
site.</p>
</div></blockquote>
<p><strong>use_scatter</strong> : bool, optional</p>
<blockquote>
<div><p>Include information derived from the scattering environment (b-factor,
occupancy, FoFc peak, 2FoFc peak and width, f&#8217;&#8217; values)</p>
</div></blockquote>
<p><strong>use_chem</strong> : bool, optional</p>
<blockquote>
<div><p>Include information derived from the chemical environment (Geometry,
coordinating atom identities, valences).</p>
</div></blockquote>
<p><strong>b_iso</strong> : bool, optional</p>
<blockquote>
<div><p>Include the atom&#8217;s refined isotropic b-factor, divided by the mean
b-factor of solvent molecules in the structure.</p>
</div></blockquote>
<p><strong>occ</strong> : bool, optional</p>
<blockquote>
<div><p>Include the atom&#8217;s refined occupancy.</p>
</div></blockquote>
<p><strong>diff_peak</strong> : bool, optional</p>
<blockquote>
<div><p>Include the difference map peak height.</p>
</div></blockquote>
<p><strong>geometry</strong> : bool, optional</p>
<blockquote>
<div><p>Include information about the presence of various geometries.</p>
</div></blockquote>
<p><strong>elements</strong> : list of str, optional</p>
<blockquote>
<div><dl class="docutils">
<dt>List of elements to include when calculating BVS, VECSUM, and f&#8217;&#8216;_expected</dt>
<dd><p class="first last">values. If unset, takes the list from mmtbx.ions.ALLOWED_IONS.</p>
</dd>
</dl>
</div></blockquote>
<p><strong>valence</strong> : bool, optional</p>
<blockquote>
<div><p>Include BVS and VECSUM values.</p>
</div></blockquote>
<p><strong>anom</strong> : bool, optional</p>
<blockquote>
<div><p>Include anomalous scattering information.</p>
</div></blockquote>
<p><strong>ratios</strong> : bool, optional</p>
<blockquote>
<div><p>Use f&#8217;&#8217; / f&#8217;&#8217; expected, instead of raw f&#8217;&#8217; and f&#8217; values.</p>
</div></blockquote>
<p><strong>anom_peak</strong> : bool, optional</p>
<blockquote>
<div><p>Whether to use the actual height of the anomalous map instead of the
calculated f&#8217;&#8217; values.</p>
</div></blockquote>
<p><strong>d_min</strong> : bool, optional</p>
<blockquote>
<div><p>Include the high resolution associated with the model as a feature.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">numpy.array of float</p>
<blockquote class="last">
<div><p>A vector containing quantitative properties for classification.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#mmtbx.ions.svm.ion_model_vector" title="mmtbx.ions.svm.ion_model_vector"><tt class="xref py py-obj docutils literal"><span class="pre">ion_model_vector</span></tt></a>, <a class="reference internal" href="#mmtbx.ions.svm.ion_electron_density_vector" title="mmtbx.ions.svm.ion_electron_density_vector"><tt class="xref py py-obj docutils literal"><span class="pre">ion_electron_density_vector</span></tt></a>, <a class="reference internal" href="#mmtbx.ions.svm.ion_geometry_vector" title="mmtbx.ions.svm.ion_geometry_vector"><tt class="xref py py-obj docutils literal"><span class="pre">ion_geometry_vector</span></tt></a>, <a class="reference internal" href="#mmtbx.ions.svm.ion_nearby_atoms_vector" title="mmtbx.ions.svm.ion_nearby_atoms_vector"><tt class="xref py py-obj docutils literal"><span class="pre">ion_nearby_atoms_vector</span></tt></a>, <a class="reference internal" href="#mmtbx.ions.svm.ion_valence_vector" title="mmtbx.ions.svm.ion_valence_vector"><tt class="xref py py-obj docutils literal"><span class="pre">ion_valence_vector</span></tt></a>, <a class="reference internal" href="#mmtbx.ions.svm.ion_anomalous_vector" title="mmtbx.ions.svm.ion_anomalous_vector"><tt class="xref py py-obj docutils literal"><span class="pre">ion_anomalous_vector</span></tt></a></p>
</div>
</dd></dl>

<dl class="class">
<dt id="mmtbx.ions.svm.manager">
<em class="property">class </em><tt class="descclassname">mmtbx.ions.svm.</tt><tt class="descname">manager</tt><big>(</big><em>fmodel</em>, <em>pdb_hierarchy</em>, <em>xray_structure</em>, <em>params=None</em>, <em>wavelength=None</em>, <em>connectivity=None</em>, <em>nproc=1</em>, <em>verbose=False</em>, <em>log=None</em><big>)</big><a class="headerlink" href="#mmtbx.ions.svm.manager" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="mmtbx.ions.identify.html#mmtbx.ions.identify.manager" title="mmtbx.ions.identify.manager"><tt class="xref py py-class docutils literal"><span class="pre">mmtbx.ions.identify.manager</span></tt></a></p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><tt class="xref py py-obj docutils literal"><span class="pre">analyze_substructure</span></tt>([log,&nbsp;verbose])</td>
<td>Given a list of AX pseudo-atoms placed by Phaser, finds the nearest real atoms, and if possible determines their equivalence.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#mmtbx.ions.svm.manager.analyze_water" title="mmtbx.ions.svm.manager.analyze_water"><tt class="xref py py-obj docutils literal"><span class="pre">analyze_water</span></tt></a>(i_seq[,&nbsp;debug,&nbsp;candidates,&nbsp;...])</td>
<td>Analyzes a single water site using a SVM to decide whether to re-assign it as an ion.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#mmtbx.ions.svm.manager.analyze_waters" title="mmtbx.ions.svm.manager.analyze_waters"><tt class="xref py py-obj docutils literal"><span class="pre">analyze_waters</span></tt></a>([out,&nbsp;debug,&nbsp;candidates])</td>
<td>Uses a SVM to analyze all of a model&#8217;s water sites and decide whether to re-assign them as ions.</td>
</tr>
<tr class="row-even"><td><tt class="xref py py-obj docutils literal"><span class="pre">find_nearby_atoms</span></tt>(i_seq[,&nbsp;...])</td>
<td>Given site in the structure, return a list of contacts, optionally filtering by connectivity and 2mFo-DFc map level.</td>
</tr>
<tr class="row-odd"><td><tt class="xref py py-obj docutils literal"><span class="pre">get_b_iso</span></tt>(i_seq)</td>
<td>Calculates the isotropic b-factor of a site.</td>
</tr>
<tr class="row-even"><td><tt class="xref py py-obj docutils literal"><span class="pre">get_fp</span></tt>(i_seq)</td>
<td>Retrieve the refined f&#8217; for a site.</td>
</tr>
<tr class="row-odd"><td><tt class="xref py py-obj docutils literal"><span class="pre">get_fpp</span></tt>(i_seq)</td>
<td>Retrieve the refined f&#8217;&#8217; for a site.</td>
</tr>
<tr class="row-even"><td><tt class="xref py py-obj docutils literal"><span class="pre">get_initial_b_iso</span></tt>()</td>
<td>Calculates the isotropic b-factor to assign to newly labeled ions during the building process.</td>
</tr>
<tr class="row-odd"><td><tt class="xref py py-obj docutils literal"><span class="pre">get_map</span></tt>(map_type)</td>
<td>Creates the real-space version of a given map type.</td>
</tr>
<tr class="row-even"><td><tt class="xref py py-obj docutils literal"><span class="pre">get_map_gaussian_fit</span></tt>(map_type,&nbsp;i_seq)</td>
<td>Retrieves the two parameters of a gaussian function, fit to a given map at a site.</td>
</tr>
<tr class="row-odd"><td><tt class="xref py py-obj docutils literal"><span class="pre">get_map_sphere_variance</span></tt>(i_seq)</td>
<td>Calculate the density levels for points on a sphere around a given point.</td>
</tr>
<tr class="row-even"><td><tt class="xref py py-obj docutils literal"><span class="pre">get_strict_valence_flag</span></tt>()</td>
<td>Checks whether the resolution of a model is high enough to use more strict thresholds for ion valences.</td>
</tr>
<tr class="row-odd"><td><tt class="xref py py-obj docutils literal"><span class="pre">guess_b_iso_real</span></tt>(i_seq)</td>
<td>Guess an approximate B_iso for an atom by averaging the values for coordinating atoms.</td>
</tr>
<tr class="row-even"><td><tt class="xref py py-obj docutils literal"><span class="pre">guess_molecular_weight</span></tt>(i_seq)</td>
<td>Guesses the molecular weight of a site by scaling the signal from the mFo map by the average signal from carbon atoms.</td>
</tr>
<tr class="row-odd"><td><tt class="xref py py-obj docutils literal"><span class="pre">looks_like_halide_ion</span></tt>(i_seq[,&nbsp;element,&nbsp;...])</td>
<td>Given a site, analyze the nearby atoms (taking geometry into account) to guess whether it might be a halide ion.</td>
</tr>
<tr class="row-even"><td><tt class="xref py py-obj docutils literal"><span class="pre">map_stats</span></tt>(i_seq)</td>
<td>Given a site in the structure, find the signal of the 2FoFc, FoFc, and anomalous map (When available).</td>
</tr>
<tr class="row-odd"><td><tt class="xref py py-obj docutils literal"><span class="pre">principal_axes_of_inertia</span></tt>(i_seq)</td>
<td>Extracts the map grid points around a site, and calculates the axes of inertia (using the density values as weights).</td>
</tr>
<tr class="row-even"><td><tt class="xref py py-obj docutils literal"><span class="pre">refine_anomalous_substructure</span></tt>(log)</td>
<td>Run simple &#8220;substructure completion&#8221; implemented using CCTBX tools (the command-line equivalent is mmtbx.refine_anomalous_substructure).</td>
</tr>
<tr class="row-odd"><td><tt class="xref py py-obj docutils literal"><span class="pre">show_current_scattering_statistics</span></tt>([out])</td>
<td>Prints out information about an entire model&#8217;s scattering statistics, such as mean map heights and b-factors for carbons and waters.</td>
</tr>
<tr class="row-even"><td><tt class="xref py py-obj docutils literal"><span class="pre">update_maps</span></tt>()</td>
<td>Generate new maps for the current structure, including anomalous map if data are anomalous.</td>
</tr>
<tr class="row-odd"><td><tt class="xref py py-obj docutils literal"><span class="pre">update_structure</span></tt>(pdb_hierarchy,&nbsp;xray_structure)</td>
<td>Set the current atomic data: PDB hierarchy, Xray structure, and simple connectivity list.</td>
</tr>
<tr class="row-even"><td><tt class="xref py py-obj docutils literal"><span class="pre">validate_ion</span></tt>(i_seq[,&nbsp;out,&nbsp;debug])</td>
<td>Examines one site in the model and determines if it was correctly modelled, returning a boolean indicating correctness.</td>
</tr>
<tr class="row-odd"><td><tt class="xref py py-obj docutils literal"><span class="pre">validate_ions</span></tt>([out,&nbsp;debug,&nbsp;segid])</td>
<td>Iterate over all the ions built into the model by this module and double check their correctness.</td>
</tr>
<tr class="row-even"><td><tt class="xref py py-obj docutils literal"><span class="pre">water_selection</span></tt>()</td>
<td>Fetchs the selection for all waters in the model.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="mmtbx.ions.svm.manager.analyze_water">
<tt class="descname">analyze_water</tt><big>(</big><em>i_seq</em>, <em>debug=True</em>, <em>candidates=&lt;libtbx.AutoType object at 0x7fce877d3350&gt;</em>, <em>filter_outputs=True</em><big>)</big><a class="headerlink" href="#mmtbx.ions.svm.manager.analyze_water" title="Permalink to this definition">¶</a></dt>
<dd><p>Analyzes a single water site using a SVM to decide whether to re-assign it
as an ion.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>i_seq</strong> : int</p>
<p><strong>debug</strong> : bool, optional</p>
<p><strong>candidates</strong> : list of str, optional</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">svm_prediction or None</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mmtbx.ions.svm.manager.analyze_waters">
<tt class="descname">analyze_waters</tt><big>(</big><em>out=&lt;open file '&lt;stdout&gt;'</em>, <em>mode 'w' at 0x7fce8fb92150&gt;</em>, <em>debug=True</em>, <em>candidates=&lt;libtbx.AutoType object at 0x7fce877d3350&gt;</em><big>)</big><a class="headerlink" href="#mmtbx.ions.svm.manager.analyze_waters" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses a SVM to analyze all of a model&#8217;s water sites and decide whether to
re-assign them as ions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>out</strong> : file, optional</p>
<p><strong>debug</strong> : bool, optional</p>
<p><strong>candidates</strong> : list of str, optional</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">list of svm_prediction</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="mmtbx.ions.svm.predict_ion">
<tt class="descclassname">mmtbx.ions.svm.</tt><tt class="descname">predict_ion</tt><big>(</big><em>chem_env</em>, <em>scatter_env</em>, <em>elements=None</em>, <em>svm_name=None</em><big>)</big><a class="headerlink" href="#mmtbx.ions.svm.predict_ion" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses the trained classifier to predict the ions that most likely fit a given
list of features about the site.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>chem_env</strong> : mmtbx.ions.environment.ChemicalEnvironment</p>
<blockquote>
<div><p>A object containing information about the chemical environment at a site.</p>
</div></blockquote>
<p><strong>scatter_env</strong> : mmtbx.ions.environment.ScatteringEnvironment, optional</p>
<blockquote>
<div><p>An object containing information about the scattering environment at a
site.</p>
</div></blockquote>
<p><strong>elements</strong> : list of str, optional</p>
<blockquote>
<div><p>A list of elements to include within the prediction. Must be a subset of
mmtbx.ions.svm.ALLOWED_IONS. Note: Water is not added to elements by
default.</p>
</div></blockquote>
<p><strong>svm_name</strong> : str, optional</p>
<blockquote>
<div><p>The SVM to use for prediction. By default, the SVM trained on heavy atoms
and calcium in the presence of anomalous data is used</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">list of tuple of str, float or None</p>
<blockquote class="last">
<div><p>A sorted list of classes and the predicted probabilities associated with
each or None if the trained classifier cannot be loaded.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="mmtbx.ions.svm.svm_prediction">
<em class="property">class </em><tt class="descclassname">mmtbx.ions.svm.</tt><tt class="descname">svm_prediction</tt><big>(</big><em>**kwds</em><big>)</big><a class="headerlink" href="#mmtbx.ions.svm.svm_prediction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../libtbx/index.html#libtbx.slots_getstate_setstate_default_initializer" title="libtbx.slots_getstate_setstate_default_initializer"><tt class="xref py py-class docutils literal"><span class="pre">libtbx.slots_getstate_setstate_default_initializer</span></tt></a></p>
<p>Contains information about a SVM&#8217;s prediction of a site&#8217;s identity.</p>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="14%" />
<col width="86%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>i_seq</td>
<td>(int)</td>
</tr>
<tr class="row-even"><td>pdb_id_str</td>
<td>(str)</td>
</tr>
<tr class="row-odd"><td>atom_info_str</td>
<td>(str)</td>
</tr>
<tr class="row-even"><td>map_stats</td>
<td>(group_args)</td>
</tr>
<tr class="row-odd"><td>atom_types</td>
<td>(list of str)</td>
</tr>
<tr class="row-even"><td>scores</td>
<td>(list of float) Probabilities associated with each element listed by atom_types.</td>
</tr>
<tr class="row-odd"><td>final_choice</td>
<td>(mmtbx.ions.metal_parameters)</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#mmtbx.ions.svm.svm_prediction.show" title="mmtbx.ions.svm.svm_prediction.show"><tt class="xref py py-obj docutils literal"><span class="pre">show</span></tt></a>([out,&nbsp;prefix])</td>
<td>Shows information about a SVM&#8217;s prediction of a site&#8217;s identity.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#mmtbx.ions.svm.svm_prediction.show_brief" title="mmtbx.ions.svm.svm_prediction.show_brief"><tt class="xref py py-obj docutils literal"><span class="pre">show_brief</span></tt></a>([out,&nbsp;prefix])</td>
<td>Shows a brief description of a SVM&#8217;s prediction of a site&#8217;s identity, for use in output as a table.</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="mmtbx.ions.svm.svm_prediction.atom_info_str">
<tt class="descname">atom_info_str</tt><a class="headerlink" href="#mmtbx.ions.svm.svm_prediction.atom_info_str" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="mmtbx.ions.svm.svm_prediction.atom_types">
<tt class="descname">atom_types</tt><a class="headerlink" href="#mmtbx.ions.svm.svm_prediction.atom_types" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="mmtbx.ions.svm.svm_prediction.final_choice">
<tt class="descname">final_choice</tt><a class="headerlink" href="#mmtbx.ions.svm.svm_prediction.final_choice" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="mmtbx.ions.svm.svm_prediction.i_seq">
<tt class="descname">i_seq</tt><a class="headerlink" href="#mmtbx.ions.svm.svm_prediction.i_seq" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="mmtbx.ions.svm.svm_prediction.map_stats">
<tt class="descname">map_stats</tt><a class="headerlink" href="#mmtbx.ions.svm.svm_prediction.map_stats" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="mmtbx.ions.svm.svm_prediction.pdb_id_str">
<tt class="descname">pdb_id_str</tt><a class="headerlink" href="#mmtbx.ions.svm.svm_prediction.pdb_id_str" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="mmtbx.ions.svm.svm_prediction.scores">
<tt class="descname">scores</tt><a class="headerlink" href="#mmtbx.ions.svm.svm_prediction.scores" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="mmtbx.ions.svm.svm_prediction.show">
<tt class="descname">show</tt><big>(</big><em>out=&lt;open file '&lt;stdout&gt;'</em>, <em>mode 'w' at 0x7fce8fb92150&gt;</em>, <em>prefix=''</em><big>)</big><a class="headerlink" href="#mmtbx.ions.svm.svm_prediction.show" title="Permalink to this definition">¶</a></dt>
<dd><p>Shows information about a SVM&#8217;s prediction of a site&#8217;s identity.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>out</strong> : file, optional</p>
<p class="last"><strong>prefix</strong> : str, optional</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mmtbx.ions.svm.svm_prediction.show_brief">
<tt class="descname">show_brief</tt><big>(</big><em>out=&lt;open file '&lt;stdout&gt;'</em>, <em>mode 'w' at 0x7fce8fb92150&gt;</em>, <em>prefix=''</em><big>)</big><a class="headerlink" href="#mmtbx.ions.svm.svm_prediction.show_brief" title="Permalink to this definition">¶</a></dt>
<dd><p>Shows a brief description of a SVM&#8217;s prediction of a site&#8217;s identity, for
use in output as a table.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>out</strong> : file, optional</p>
<p class="last"><strong>prefix</strong> : str, optional</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">mmtbx.ions.svm package</a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-mmtbx.ions.svm">Module contents</a><ul>
<li><a class="reference internal" href="#see-also">See Also</a><ul>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="mmtbx.ions.html"
                        title="previous chapter">mmtbx.ions package</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="mmtbx.ions.svm.dump_sites.html"
                        title="next chapter">mmtbx.ions.svm.dump_sites module</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/mmtbx/mmtbx.ions.svm.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="mmtbx.ions.svm.dump_sites.html" title="mmtbx.ions.svm.dump_sites module"
             >next</a> |</li>
        <li class="right" >
          <a href="mmtbx.ions.html" title="mmtbx.ions package"
             >previous</a> |</li>
        <li><a href="../index.html">CCTBX None documentation</a> &raquo;</li>
          <li><a href="mmtbx.html" >mmtbx - macromolecular crystallography</a> &raquo;</li>
          <li><a href="mmtbx.ions.html" >mmtbx.ions package</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2014, University of California.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>