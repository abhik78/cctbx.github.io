<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>iotbx.ncs package &mdash; CCTBX None documentation</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     'None',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="CCTBX None documentation" href="../index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../index.html">CCTBX None documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="iotbx-ncs-package">
<h1>iotbx.ncs package<a class="headerlink" href="#iotbx-ncs-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-iotbx.ncs.ncs_preprocess">
<span id="iotbx-ncs-ncs-preprocess-module"></span><h2>iotbx.ncs.ncs_preprocess module<a class="headerlink" href="#module-iotbx.ncs.ncs_preprocess" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="iotbx.ncs.ncs_preprocess.NCS_copy">
<em class="property">class </em><tt class="descclassname">iotbx.ncs.ncs_preprocess.</tt><tt class="descname">NCS_copy</tt><big>(</big><em>copy_iselection</em>, <em>rot</em>, <em>tran</em><big>)</big><a class="headerlink" href="#iotbx.ncs.ncs_preprocess.NCS_copy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="iotbx.ncs.ncs_preprocess.NCS_restraint_group">
<em class="property">class </em><tt class="descclassname">iotbx.ncs.ncs_preprocess.</tt><tt class="descname">NCS_restraint_group</tt><big>(</big><em>master_iselection</em><big>)</big><a class="headerlink" href="#iotbx.ncs.ncs_preprocess.NCS_restraint_group" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="http://docs.python.org/library/functions.html#object" title="(in Python v2.7)"><tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></a></p>
</dd></dl>

<dl class="class">
<dt id="iotbx.ncs.ncs_preprocess.Transform">
<em class="property">class </em><tt class="descclassname">iotbx.ncs.ncs_preprocess.</tt><tt class="descname">Transform</tt><big>(</big><em>rotation=None</em>, <em>translation=None</em>, <em>serial_num=None</em>, <em>coordinates_present=None</em>, <em>ncs_group_id=None</em>, <em>rmsd=0.0</em><big>)</big><a class="headerlink" href="#iotbx.ncs.ncs_preprocess.Transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="http://docs.python.org/library/functions.html#object" title="(in Python v2.7)"><tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></a></p>
<p>Transformation object</p>
</dd></dl>

<dl class="function">
<dt id="iotbx.ncs.ncs_preprocess.add_to_dict">
<tt class="descclassname">iotbx.ncs.ncs_preprocess.</tt><tt class="descname">add_to_dict</tt><big>(</big><em>d</em>, <em>k</em>, <em>v</em><big>)</big><a class="headerlink" href="#iotbx.ncs.ncs_preprocess.add_to_dict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="iotbx.ncs.ncs_preprocess.all_ncs_copies_present">
<tt class="descclassname">iotbx.ncs.ncs_preprocess.</tt><tt class="descname">all_ncs_copies_present</tt><big>(</big><em>transform_info</em><big>)</big><a class="headerlink" href="#iotbx.ncs.ncs_preprocess.all_ncs_copies_present" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if all transforms coordinates are present,
if the complete ASU is present</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>transform_info: (transformation object)</dd>
<dt>Returns:</dt>
<dd>(bool)</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="iotbx.ncs.ncs_preprocess.chains_in_string">
<tt class="descclassname">iotbx.ncs.ncs_preprocess.</tt><tt class="descname">chains_in_string</tt><big>(</big><em>s</em><big>)</big><a class="headerlink" href="#iotbx.ncs.ncs_preprocess.chains_in_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a string of chain IDs from a selection string or a selection
string list</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">chains_in_string</span><span class="p">(</span><span class="s">&#39;chain D or (chain F and (resseq 2:10))&#39;</span><span class="p">)</span>
<span class="go">[&#39;D&#39;, &#39;F&#39;]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">chains_in_string</span><span class="p">([</span><span class="s">&#39;chain D&#39;</span><span class="p">,</span><span class="s">&#39;(chain F and (resseq 2:10))&#39;</span><span class="p">])</span>
<span class="go">[&#39;D&#39;, &#39;F&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="iotbx.ncs.ncs_preprocess.clean_chain_id">
<tt class="descclassname">iotbx.ncs.ncs_preprocess.</tt><tt class="descname">clean_chain_id</tt><big>(</big><em>ph_model</em><big>)</big><a class="headerlink" href="#iotbx.ncs.ncs_preprocess.clean_chain_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Make sure chain names do not contain leading or trailing spaces</p>
</dd></dl>

<dl class="function">
<dt id="iotbx.ncs.ncs_preprocess.format_80">
<tt class="descclassname">iotbx.ncs.ncs_preprocess.</tt><tt class="descname">format_80</tt><big>(</big><em>s</em><big>)</big><a class="headerlink" href="#iotbx.ncs.ncs_preprocess.format_80" title="Permalink to this definition">¶</a></dt>
<dd><p>Split string that is longer than 80 characters to several lines</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>s (str)</dd>
<dt>Returns:</dt>
<dd>ss (str): formatted string</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="iotbx.ncs.ncs_preprocess.format_num_as_str">
<tt class="descclassname">iotbx.ncs.ncs_preprocess.</tt><tt class="descname">format_num_as_str</tt><big>(</big><em>n</em><big>)</big><a class="headerlink" href="#iotbx.ncs.ncs_preprocess.format_num_as_str" title="Permalink to this definition">¶</a></dt>
<dd><p>return a 3 digit string of n</p>
</dd></dl>

<dl class="function">
<dt id="iotbx.ncs.ncs_preprocess.get_center_orth">
<tt class="descclassname">iotbx.ncs.ncs_preprocess.</tt><tt class="descname">get_center_orth</tt><big>(</big><em>xyz</em>, <em>selection</em><big>)</big><a class="headerlink" href="#iotbx.ncs.ncs_preprocess.get_center_orth" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the center of coordinates of selected coordinates</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>xyz (flex.vec3_double): Atoms coordinates
selection (flex.bool): Atom selection array</dd>
<dt>Returns:</dt>
<dd>(tuple) center of coordinates for the selected coordinates
Returns (-100,-100,-100) when selection is bad</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="iotbx.ncs.ncs_preprocess.get_list_of_chains_selection">
<tt class="descclassname">iotbx.ncs.ncs_preprocess.</tt><tt class="descname">get_list_of_chains_selection</tt><big>(</big><em>selection_str</em><big>)</big><a class="headerlink" href="#iotbx.ncs.ncs_preprocess.get_list_of_chains_selection" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Args:</dt>
<dd>selection_str: (str) selection string</dd>
<dt>Returns:</dt>
<dd>(list of str) of the format [&#8216;chain X&#8217;, &#8216;chain Y&#8217;,...]</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="iotbx.ncs.ncs_preprocess.get_ncs_group_selection">
<tt class="descclassname">iotbx.ncs.ncs_preprocess.</tt><tt class="descname">get_ncs_group_selection</tt><big>(</big><em>chain_residue_id</em><big>)</big><a class="headerlink" href="#iotbx.ncs.ncs_preprocess.get_ncs_group_selection" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Args:</dt>
<dd>chain_residue_id: [[chain id&#8217;s],[[[residues range]],[[...]]]</dd>
<dt>Returns:</dt>
<dd>selection lists, with selection string for each ncs copy in the group</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="iotbx.ncs.ncs_preprocess.get_pdb_header">
<tt class="descclassname">iotbx.ncs.ncs_preprocess.</tt><tt class="descname">get_pdb_header</tt><big>(</big><em>pdb_str</em><big>)</big><a class="headerlink" href="#iotbx.ncs.ncs_preprocess.get_pdb_header" title="Permalink to this definition">¶</a></dt>
<dd><p>Collect CRYST and SCALE records</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>pdb_str: (str) pdb type string</dd>
<dt>Returns:</dt>
<dd>the portion of the pdb_str till the first ATOM</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="iotbx.ncs.ncs_preprocess.get_residue_sequence">
<tt class="descclassname">iotbx.ncs.ncs_preprocess.</tt><tt class="descname">get_residue_sequence</tt><big>(</big><em>ph</em><big>)</big><a class="headerlink" href="#iotbx.ncs.ncs_preprocess.get_residue_sequence" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a list of residues numbers and names from hierarchy &#8220;ph&#8221;, excluding
water molecules</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>ph (hierarchy): hierarchy of a single chain</dd>
<dt>Returns:</dt>
<dd>res_list_new (list of str): list of residues names
resid_list_new (list of str): list of residues number</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="iotbx.ncs.ncs_preprocess.get_rot_trans">
<tt class="descclassname">iotbx.ncs.ncs_preprocess.</tt><tt class="descname">get_rot_trans</tt><big>(</big><em>ph=None</em>, <em>master_selection=None</em>, <em>copy_selection=None</em>, <em>max_rmsd=0.02</em><big>)</big><a class="headerlink" href="#iotbx.ncs.ncs_preprocess.get_rot_trans" title="Permalink to this definition">¶</a></dt>
<dd><p>Get rotation and translation using superpose.</p>
<p>This function is used only when phil parameters are provided. In this case
we require the selection of NCS master and copies to be correct.
Correct means:</p>
<blockquote>
<div><ol class="arabic simple">
<li>residue sequence in master and copies is exactly the same</li>
<li>the number of atoms in master and copies is exactly the same</li>
</ol>
</div></blockquote>
<p>One can get exact selection strings by ncs_object.show(verbose=True)</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">ph : pdb hierarchy input object
master/copy_selection (str): master and copy selection strings
max_rmsd (float): limit of rms difference between chains to be considered</p>
<blockquote class="last">
<div>as copies</div></blockquote>
</dd>
<dt>Returns:</dt>
<dd>r: rotation matrix
t: translation vector
rmsd (float): RMSD between master and copy
msg (str): error messages</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="iotbx.ncs.ncs_preprocess.get_transform_order">
<tt class="descclassname">iotbx.ncs.ncs_preprocess.</tt><tt class="descname">get_transform_order</tt><big>(</big><em>transform_to_ncs</em><big>)</big><a class="headerlink" href="#iotbx.ncs.ncs_preprocess.get_transform_order" title="Permalink to this definition">¶</a></dt>
<dd><p>order transforms mainly for proper chain naming</p>
</dd></dl>

<dl class="function">
<dt id="iotbx.ncs.ncs_preprocess.insure_identity_is_in_transform_info">
<tt class="descclassname">iotbx.ncs.ncs_preprocess.</tt><tt class="descname">insure_identity_is_in_transform_info</tt><big>(</big><em>transform_info</em><big>)</big><a class="headerlink" href="#iotbx.ncs.ncs_preprocess.insure_identity_is_in_transform_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Add the identity matrix in cases where the pdb or mmcif files do not
contain it</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first last docutils">
<dt>transform_info (transformation object): contain rotation, translation,</dt>
<dd>serial number and indication if present</dd>
</dl>
</dd>
<dt>Return:</dt>
<dd><dl class="first last docutils">
<dt>transform_info <span class="classifier-delimiter">:</span> <span class="classifier">Add or reorder the transform_info so that the</span></dt>
<dd>identity matrix has serial number 1</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="iotbx.ncs.ncs_preprocess.inverse_transform">
<tt class="descclassname">iotbx.ncs.ncs_preprocess.</tt><tt class="descname">inverse_transform</tt><big>(</big><em>r</em>, <em>t</em><big>)</big><a class="headerlink" href="#iotbx.ncs.ncs_preprocess.inverse_transform" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="iotbx.ncs.ncs_preprocess.is_identity">
<tt class="descclassname">iotbx.ncs.ncs_preprocess.</tt><tt class="descname">is_identity</tt><big>(</big><em>r</em>, <em>t</em><big>)</big><a class="headerlink" href="#iotbx.ncs.ncs_preprocess.is_identity" title="Permalink to this definition">¶</a></dt>
<dd><p>test if r, rotation matrix is identity, and t, translation is zero</p>
</dd></dl>

<dl class="function">
<dt id="iotbx.ncs.ncs_preprocess.make_chain_names_list">
<tt class="descclassname">iotbx.ncs.ncs_preprocess.</tt><tt class="descname">make_chain_names_list</tt><big>(</big><em>unique_chain_names</em><big>)</big><a class="headerlink" href="#iotbx.ncs.ncs_preprocess.make_chain_names_list" title="Permalink to this definition">¶</a></dt>
<dd><p>make new chain names</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>unique_chain_names (list of str): a list of existing chain names</dd>
<dt>Returns:</dt>
<dd>(list of str): a list of potential new names</dd>
</dl>
</dd></dl>

<dl class="class">
<dt id="iotbx.ncs.ncs_preprocess.ncs_group_object">
<em class="property">class </em><tt class="descclassname">iotbx.ncs.ncs_preprocess.</tt><tt class="descname">ncs_group_object</tt><a class="headerlink" href="#iotbx.ncs.ncs_preprocess.ncs_group_object" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="http://docs.python.org/library/functions.html#object" title="(in Python v2.7)"><tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></a></p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.add_identity_transform" title="iotbx.ncs.ncs_preprocess.ncs_group_object.add_identity_transform"><tt class="xref py py-obj docutils literal"><span class="pre">add_identity_transform</span></tt></a>(ncs_selection[,&nbsp;...])</td>
<td>Add identity transform</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.add_transforms_to_ncs_refinement_groups" title="iotbx.ncs.ncs_preprocess.ncs_group_object.add_transforms_to_ncs_refinement_groups"><tt class="xref py py-obj docutils literal"><span class="pre">add_transforms_to_ncs_refinement_groups</span></tt></a>(...)</td>
<td>Add rotation matrices and translations vectors</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.build_MTRIX_object" title="iotbx.ncs.ncs_preprocess.ncs_group_object.build_MTRIX_object"><tt class="xref py py-obj docutils literal"><span class="pre">build_MTRIX_object</span></tt></a>([ncs_only])</td>
<td>Build a MTRIX object from ncs_group_object</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.build_asu_hierarchy" title="iotbx.ncs.ncs_preprocess.ncs_group_object.build_asu_hierarchy"><tt class="xref py py-obj docutils literal"><span class="pre">build_asu_hierarchy</span></tt></a>(pdb_hierarchy[,&nbsp;...])</td>
<td>Build ASU hierarchy</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.build_ncs_obj_from_group_dict" title="iotbx.ncs.ncs_preprocess.ncs_group_object.build_ncs_obj_from_group_dict"><tt class="xref py py-obj docutils literal"><span class="pre">build_ncs_obj_from_group_dict</span></tt></a>(group_dict,&nbsp;...)</td>
<td>Use group_dict to build ncs object</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.build_ncs_obj_from_pdb_asu" title="iotbx.ncs.ncs_preprocess.ncs_group_object.build_ncs_obj_from_pdb_asu"><tt class="xref py py-obj docutils literal"><span class="pre">build_ncs_obj_from_pdb_asu</span></tt></a>(pdb_hierarchy_inp)</td>
<td>Build transforms objects and NCS &lt;-&gt; ASU mapping from a complete ASU</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.build_ncs_obj_from_pdb_ncs" title="iotbx.ncs.ncs_preprocess.ncs_group_object.build_ncs_obj_from_pdb_ncs"><tt class="xref py py-obj docutils literal"><span class="pre">build_ncs_obj_from_pdb_ncs</span></tt></a>(pdb_hierarchy_inp)</td>
<td>Build transforms objects and NCS &lt;-&gt; ASU mapping using PDB file containing</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.build_ncs_obj_from_phil" title="iotbx.ncs.ncs_preprocess.ncs_group_object.build_ncs_obj_from_phil"><tt class="xref py py-obj docutils literal"><span class="pre">build_ncs_obj_from_phil</span></tt></a>([ncs_phil_string,&nbsp;...])</td>
<td>Build transforms objects and NCS &lt;-&gt; ASU mapping using phil selection</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.build_ncs_obj_from_spec_file" title="iotbx.ncs.ncs_preprocess.ncs_group_object.build_ncs_obj_from_spec_file"><tt class="xref py py-obj docutils literal"><span class="pre">build_ncs_obj_from_spec_file</span></tt></a>([file_name,&nbsp;...])</td>
<td>read .spec files and build transforms object and NCS &lt;-&gt; ASU mapping</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.build_transform_dict" title="iotbx.ncs.ncs_preprocess.ncs_group_object.build_transform_dict"><tt class="xref py py-obj docutils literal"><span class="pre">build_transform_dict</span></tt></a>(transform_id,&nbsp;...)</td>
<td>Apply all non-identity transforms</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.collect_basic_info_from_pdb" title="iotbx.ncs.ncs_preprocess.ncs_group_object.collect_basic_info_from_pdb"><tt class="xref py py-obj docutils literal"><span class="pre">collect_basic_info_from_pdb</span></tt></a>(pdb_hierarchy_inp)</td>
<td>Build chain selection string and collect chains IDs from pdb</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.compute_ncs_asu_coordinates_map" title="iotbx.ncs.ncs_preprocess.ncs_group_object.compute_ncs_asu_coordinates_map"><tt class="xref py py-obj docutils literal"><span class="pre">compute_ncs_asu_coordinates_map</span></tt></a>(...)</td>
<td>Calculates coordinates maps from ncs to asu and from asu to ncs</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.create_ncs_domain_pdb_files" title="iotbx.ncs.ncs_preprocess.ncs_group_object.create_ncs_domain_pdb_files"><tt class="xref py py-obj docutils literal"><span class="pre">create_ncs_domain_pdb_files</span></tt></a>([hierarchy,&nbsp;...])</td>
<td>Create a PDB file for each NCS group, that contains only the</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.finalize_pre_process" title="iotbx.ncs.ncs_preprocess.ncs_group_object.finalize_pre_process"><tt class="xref py py-obj docutils literal"><span class="pre">finalize_pre_process</span></tt></a>([pdb_hierarchy_inp])</td>
<td>Steps that are common to most method of transform info</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.get_array_of_selections" title="iotbx.ncs.ncs_preprocess.ncs_group_object.get_array_of_selections"><tt class="xref py py-obj docutils literal"><span class="pre">get_array_of_selections</span></tt></a>()</td>
<td>Returns array of phil selection strings e.g.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.get_asu_length" title="iotbx.ncs.ncs_preprocess.ncs_group_object.get_asu_length"><tt class="xref py py-obj docutils literal"><span class="pre">get_asu_length</span></tt></a>(atom_selection_cache)</td>
<td>&#8221; Collect the length of all ncs copies</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.get_ncs_info_as_spec" title="iotbx.ncs.ncs_preprocess.ncs_group_object.get_ncs_info_as_spec"><tt class="xref py py-obj docutils literal"><span class="pre">get_ncs_info_as_spec</span></tt></a>([file_name_prefix,&nbsp;...])</td>
<td>Returns ncs spec object and can prints ncs info in a ncs_spec,</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.get_ncs_restraints_group_list" title="iotbx.ncs.ncs_preprocess.ncs_group_object.get_ncs_restraints_group_list"><tt class="xref py py-obj docutils literal"><span class="pre">get_ncs_restraints_group_list</span></tt></a>([max_delta,&nbsp;...])</td>
<td>Create a list of ncs_restraint_group objects</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.get_transform_records" title="iotbx.ncs.ncs_preprocess.ncs_group_object.get_transform_records"><tt class="xref py py-obj docutils literal"><span class="pre">get_transform_records</span></tt></a>([file_name,&nbsp;ncs_only,&nbsp;...])</td>
<td>Write to a file or prints transformation records.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.look_and_combine_groups" title="iotbx.ncs.ncs_preprocess.ncs_group_object.look_and_combine_groups"><tt class="xref py py-obj docutils literal"><span class="pre">look_and_combine_groups</span></tt></a>(gr_new,&nbsp;spec_group_list)</td>
<td>In spec files groups of different masters and copies listed separately, even if they have the same rotation/translation and can be combined.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.make_chains_names" title="iotbx.ncs.ncs_preprocess.ncs_group_object.make_chains_names"><tt class="xref py py-obj docutils literal"><span class="pre">make_chains_names</span></tt></a>(transform_assignment,&nbsp;...)</td>
<td>Create a dictionary names for the new NCS copies</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.preprocess_ncs_obj" title="iotbx.ncs.ncs_preprocess.ncs_group_object.preprocess_ncs_obj"><tt class="xref py py-obj docutils literal"><span class="pre">preprocess_ncs_obj</span></tt></a>([pdb_hierarchy_inp,&nbsp;...])</td>
<td>Select method to build ncs_group_object</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.print_ncs_phil_param" title="iotbx.ncs.ncs_preprocess.ncs_group_object.print_ncs_phil_param"><tt class="xref py py-obj docutils literal"><span class="pre">print_ncs_phil_param</span></tt></a>([write,&nbsp;log])</td>
<td>Prints NCS information in the phil parameters format</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.process_pdb" title="iotbx.ncs.ncs_preprocess.ncs_group_object.process_pdb"><tt class="xref py py-obj docutils literal"><span class="pre">process_pdb</span></tt></a>(transform_info)</td>
<td>Process PDB Hierarchy object</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.set_common_res_dict" title="iotbx.ncs.ncs_preprocess.ncs_group_object.set_common_res_dict"><tt class="xref py py-obj docutils literal"><span class="pre">set_common_res_dict</span></tt></a>()</td>
<td>Build common residues list and related RMSD</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.show" title="iotbx.ncs.ncs_preprocess.ncs_group_object.show"><tt class="xref py py-obj docutils literal"><span class="pre">show</span></tt></a>([format,&nbsp;verbose,&nbsp;prefix,&nbsp;header,&nbsp;log])</td>
<td>Display NCS object</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.show_chains_info" title="iotbx.ncs.ncs_preprocess.ncs_group_object.show_chains_info"><tt class="xref py py-obj docutils literal"><span class="pre">show_chains_info</span></tt></a>([prefix])</td>
<td>Returns formatted string for print out, string containing chains IDs in a</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.show_ncs_headers" title="iotbx.ncs.ncs_preprocess.ncs_group_object.show_ncs_headers"><tt class="xref py py-obj docutils literal"><span class="pre">show_ncs_headers</span></tt></a>(prefix)</td>
<td>Returns a string of general info about NCS groups</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.show_ncs_selections" title="iotbx.ncs.ncs_preprocess.ncs_group_object.show_ncs_selections"><tt class="xref py py-obj docutils literal"><span class="pre">show_ncs_selections</span></tt></a>([prefix])</td>
<td>Return NCS selection strings as a string, for printing</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.show_phil_format" title="iotbx.ncs.ncs_preprocess.ncs_group_object.show_phil_format"><tt class="xref py py-obj docutils literal"><span class="pre">show_phil_format</span></tt></a>([prefix,&nbsp;header,&nbsp;group_prefix])</td>
<td>Returns a string of NCS groups phil parameters</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.show_search_parameters_values" title="iotbx.ncs.ncs_preprocess.ncs_group_object.show_search_parameters_values"><tt class="xref py py-obj docutils literal"><span class="pre">show_search_parameters_values</span></tt></a>([prefix])</td>
<td>Returns a string of search parameters values</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.show_transform_info" title="iotbx.ncs.ncs_preprocess.ncs_group_object.show_transform_info"><tt class="xref py py-obj docutils literal"><span class="pre">show_transform_info</span></tt></a>([prefix])</td>
<td>Returns formatted string for print out, string containing chains IDs in a</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.update_ncs_copies_chains_names" title="iotbx.ncs.ncs_preprocess.ncs_group_object.update_ncs_copies_chains_names"><tt class="xref py py-obj docutils literal"><span class="pre">update_ncs_copies_chains_names</span></tt></a>(masters,&nbsp;...)</td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.update_tr_id_to_selection" title="iotbx.ncs.ncs_preprocess.ncs_group_object.update_tr_id_to_selection"><tt class="xref py py-obj docutils literal"><span class="pre">update_tr_id_to_selection</span></tt></a>(masters,&nbsp;copies,&nbsp;tr_id)</td>
<td>Args:</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.update_using_ncs_restraints_group_list" title="iotbx.ncs.ncs_preprocess.ncs_group_object.update_using_ncs_restraints_group_list"><tt class="xref py py-obj docutils literal"><span class="pre">update_using_ncs_restraints_group_list</span></tt></a>(...)</td>
<td>Update ncs_group_object rotations and transformations.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.validate_ncs_phil_groups" title="iotbx.ncs.ncs_preprocess.ncs_group_object.validate_ncs_phil_groups"><tt class="xref py py-obj docutils literal"><span class="pre">validate_ncs_phil_groups</span></tt></a>(pdb_hierarchy_inp,&nbsp;...)</td>
<td></td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="iotbx.ncs.ncs_preprocess.ncs_group_object.add_identity_transform">
<tt class="descname">add_identity_transform</tt><big>(</big><em>ncs_selection</em>, <em>ncs_group_id=1</em>, <em>transform_sn=1</em><big>)</big><a class="headerlink" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.add_identity_transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Add identity transform
Argument:</p>
<p>ncs_selection: (str) selection string for the NCS master copy
ncs_group_id: (int) the NCS group ID
transform_sn: (int) Over all transform serial number</p>
</dd></dl>

<dl class="method">
<dt id="iotbx.ncs.ncs_preprocess.ncs_group_object.add_transforms_to_ncs_refinement_groups">
<tt class="descname">add_transforms_to_ncs_refinement_groups</tt><big>(</big><em>rotations</em>, <em>translations</em><big>)</big><a class="headerlink" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.add_transforms_to_ncs_refinement_groups" title="Permalink to this definition">¶</a></dt>
<dd><p>Add rotation matrices and translations vectors
to ncs_refinement_groups</p>
</dd></dl>

<dl class="method">
<dt id="iotbx.ncs.ncs_preprocess.ncs_group_object.build_MTRIX_object">
<tt class="descname">build_MTRIX_object</tt><big>(</big><em>ncs_only=True</em><big>)</big><a class="headerlink" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.build_MTRIX_object" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a MTRIX object from ncs_group_object
Used for testing</p>
</dd></dl>

<dl class="method">
<dt id="iotbx.ncs.ncs_preprocess.ncs_group_object.build_asu_hierarchy">
<tt class="descname">build_asu_hierarchy</tt><big>(</big><em>pdb_hierarchy</em>, <em>round_coordinates=True</em><big>)</big><a class="headerlink" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.build_asu_hierarchy" title="Permalink to this definition">¶</a></dt>
<dd><p>Build ASU hierarchy</p>
<p>Arguments:
pdb_hierarchy: pdb hierarchy of the master NCS
round_coordinates: (bool) round coordinates of new NCS copies,</p>
<blockquote>
<div>for sites_cart constancy</div></blockquote>
<p>Return:
ASU hierarchy</p>
</dd></dl>

<dl class="method">
<dt id="iotbx.ncs.ncs_preprocess.ncs_group_object.build_ncs_obj_from_group_dict">
<tt class="descname">build_ncs_obj_from_group_dict</tt><big>(</big><em>group_dict</em>, <em>pdb_hierarchy_inp</em><big>)</big><a class="headerlink" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.build_ncs_obj_from_group_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Use group_dict to build ncs object</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">pdb_hierarchy_inp : iotbx.pdb.hierarchy.input
group_dict (dict):</p>
<blockquote class="last">
<div><p>keys: tuple of master chain IDs
values: NCS_groups_container objects with Attributes:</p>
<blockquote>
<div><dl class="docutils">
<dt>iselections (list of lists of flex.size_t):</dt>
<dd>selection array for the complete ASU</dd>
</dl>
<p>residue_index_list (list): list of list of matching residues indices
copies (list of lists):List of lists of the ncs copies chain IDs
transforms (list of transform objects):</p>
<blockquote>
<div><dl class="docutils">
<dt>object with attributes:</dt>
<dd>rotation : Rotation matrix object
translation: Translation matrix object
serial_num : (int) Transform serial number
coordinates_present (bool): True when coordinates are presents
ncs_group_id (int): group ID of the group containing this transform
rmsd (float): RMS distance between ncs copies</dd>
</dl>
</div></blockquote>
</div></blockquote>
</div></blockquote>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="iotbx.ncs.ncs_preprocess.ncs_group_object.build_ncs_obj_from_pdb_asu">
<tt class="descname">build_ncs_obj_from_pdb_asu</tt><big>(</big><em>pdb_hierarchy_inp</em><big>)</big><a class="headerlink" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.build_ncs_obj_from_pdb_asu" title="Permalink to this definition">¶</a></dt>
<dd><p>Build transforms objects and NCS &lt;-&gt; ASU mapping from a complete ASU
Note that the MTRIX record are ignored, they are produced in the
process of identifying the master NCS</p>
<dl class="docutils">
<dt>Args::</dt>
<dd>pdb_hierarchy_inp : iotbx.pdb.hierarchy.input</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="iotbx.ncs.ncs_preprocess.ncs_group_object.build_ncs_obj_from_pdb_ncs">
<tt class="descname">build_ncs_obj_from_pdb_ncs</tt><big>(</big><em>pdb_hierarchy_inp</em>, <em>transform_info=None</em>, <em>rotations=None</em>, <em>translations=None</em><big>)</big><a class="headerlink" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.build_ncs_obj_from_pdb_ncs" title="Permalink to this definition">¶</a></dt>
<dd><p>Build transforms objects and NCS &lt;-&gt; ASU mapping using PDB file containing
a single NCS copy and MTRIX  or BIOMT records</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>pdb_hierarchy_inp : iotbx.pdb.hierarchy.input
transform_info : an object containing MTRIX or BIOMT transformation info
rotations : matrix.sqr 3x3 object
translations : matrix.col 3x1 object</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="iotbx.ncs.ncs_preprocess.ncs_group_object.build_ncs_obj_from_phil">
<tt class="descname">build_ncs_obj_from_phil</tt><big>(</big><em>ncs_phil_string=None</em>, <em>ncs_phil_groups=None</em>, <em>pdb_hierarchy_inp=None</em><big>)</big><a class="headerlink" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.build_ncs_obj_from_phil" title="Permalink to this definition">¶</a></dt>
<dd><p>Build transforms objects and NCS &lt;-&gt; ASU mapping using phil selection
strings and complete ASU</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>ncs_phil_string : Phil parameters
ncs_phil_groups :
pdb_hierarchy_inp : iotbx.pdb.hierarchy.input</dd>
</dl>
<p>Phil structure
ncs_group (multiple)
{</p>
<blockquote>
<div>reference = &#8216;&#8217;
selection = &#8216;&#8217;   (multiple)</div></blockquote>
<p>}</p>
</dd></dl>

<dl class="method">
<dt id="iotbx.ncs.ncs_preprocess.ncs_group_object.build_ncs_obj_from_spec_file">
<tt class="descname">build_ncs_obj_from_spec_file</tt><big>(</big><em>file_name=None</em>, <em>file_path=''</em>, <em>file_str=''</em>, <em>source_info=''</em>, <em>quiet=True</em>, <em>pdb_hierarchy_inp=None</em>, <em>spec_ncs_groups=None</em>, <em>join_same_spec_groups=True</em><big>)</big><a class="headerlink" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.build_ncs_obj_from_spec_file" title="Permalink to this definition">¶</a></dt>
<dd><p>read .spec files and build transforms object and NCS &lt;-&gt; ASU mapping</p>
<p>Arguments:
spec file information using a file, file_str (str) of a source_info (str)
quiet: (bool) quite output when True
pdb_hierarchy_inp: pdb hierarchy input
spec_ncs_groups: ncs_groups object
join_same_spec_groups: (bool) True: combine groups with similar transforms</p>
</dd></dl>

<dl class="method">
<dt id="iotbx.ncs.ncs_preprocess.ncs_group_object.build_transform_dict">
<tt class="descname">build_transform_dict</tt><big>(</big><em>transform_id</em>, <em>transform</em>, <em>selection_id</em><big>)</big><a class="headerlink" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.build_transform_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply all non-identity transforms
Build transform_to_ncs dictionary, which provides the location of the
particular chains or selections in the NCS (example key: &#8220;002&#8221;)
and updates transform_to_be_used set</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>transform_id (str): 001,002...
transform : transform object, containing information on transformation
selection_id (str): NCS selection string</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="iotbx.ncs.ncs_preprocess.ncs_group_object.collect_basic_info_from_pdb">
<tt class="descname">collect_basic_info_from_pdb</tt><big>(</big><em>pdb_hierarchy_inp</em><big>)</big><a class="headerlink" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.collect_basic_info_from_pdb" title="Permalink to this definition">¶</a></dt>
<dd><p>Build chain selection string and collect chains IDs from pdb
Consider that chains can be not continuous</p>
</dd></dl>

<dl class="method">
<dt id="iotbx.ncs.ncs_preprocess.ncs_group_object.compute_ncs_asu_coordinates_map">
<tt class="descname">compute_ncs_asu_coordinates_map</tt><big>(</big><em>pdb_hierarchy_inp</em><big>)</big><a class="headerlink" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.compute_ncs_asu_coordinates_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates coordinates maps from ncs to asu and from asu to ncs</p>
</dd></dl>

<dl class="method">
<dt id="iotbx.ncs.ncs_preprocess.ncs_group_object.create_ncs_domain_pdb_files">
<tt class="descname">create_ncs_domain_pdb_files</tt><big>(</big><em>hierarchy=None</em>, <em>exclude_chains=None</em>, <em>temp_dir=''</em><big>)</big><a class="headerlink" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.create_ncs_domain_pdb_files" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a PDB file for each NCS group, that contains only the
group NCS related atoms</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>hierarchy: PDB hierarchy object
exclude_chains (list): list of chain IDs to ignore when writing NCS to pdb
temp_dir (str): temp directory path</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="iotbx.ncs.ncs_preprocess.ncs_group_object.finalize_pre_process">
<tt class="descname">finalize_pre_process</tt><big>(</big><em>pdb_hierarchy_inp=None</em><big>)</big><a class="headerlink" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.finalize_pre_process" title="Permalink to this definition">¶</a></dt>
<dd><p>Steps that are common to most method of transform info</p>
</dd></dl>

<dl class="method">
<dt id="iotbx.ncs.ncs_preprocess.ncs_group_object.get_array_of_selections">
<tt class="descname">get_array_of_selections</tt><big>(</big><big>)</big><a class="headerlink" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.get_array_of_selections" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns array of phil selection strings e.g. for the exapmle above in
print_ncs_phil_param:
[[&#8216;(Chain A)&#8217;,&#8217;(chain C)&#8217;,&#8217;(chain E)&#8217;],[&#8216;(chain B)&#8217;,&#8217;(chain D)&#8217;,&#8217;(chain F)&#8217;]]</p>
</dd></dl>

<dl class="method">
<dt id="iotbx.ncs.ncs_preprocess.ncs_group_object.get_asu_length">
<tt class="descname">get_asu_length</tt><big>(</big><em>atom_selection_cache</em><big>)</big><a class="headerlink" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.get_asu_length" title="Permalink to this definition">¶</a></dt>
<dd><p>&#8221; Collect the length of all ncs copies</p>
</dd></dl>

<dl class="method">
<dt id="iotbx.ncs.ncs_preprocess.ncs_group_object.get_ncs_info_as_spec">
<tt class="descname">get_ncs_info_as_spec</tt><big>(</big><em>file_name_prefix=''</em>, <em>pdb_hierarchy_asu=None</em>, <em>xrs=None</em>, <em>fmodel=None</em>, <em>write=False</em>, <em>exclude_h=None</em>, <em>exclude_d=None</em>, <em>create_ncs_domain_pdb=False</em>, <em>stem=''</em>, <em>log=None</em>, <em>show_ncs_phil=False</em><big>)</big><a class="headerlink" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.get_ncs_info_as_spec" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns ncs spec object and can prints ncs info in a ncs_spec,
format_all_for_resolve or format_all_for_phenix_refine format</p>
<p>Note that while ncs_groups can master ncs can be comprised from several
chains, the spec groups can not. So groups with multiple chains in the
master selection are splitted</p>
<p>Note that spec format does not support insertions notation
for example &#8220;resseq 49&#8221; will include &#8220;resid 49&#8221; and &#8220;resid 49A&#8221;</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">file_name_prefix: (str) output file names prefix
pdb_hierarchy: (pdb_hierarchy object)
xrs: (xray structure) for crystal symmetry
fmodel: (fmodel object)
write: (bool) when False, will not write to file or print
exclude_h,exclude_d : parameters of the ncs object
restraint (bool): control the file format for phenix.refine</p>
<blockquote>
<div>when True, &#8220;refinement.ncs.restraint_group&#8221;
when False,&#8221;refinement.ncs.constraint_group&#8221;</div></blockquote>
<p class="last">show_ncs_phil (bool): add NCS groups phil info to printout</p>
</dd>
<dt>Return:</dt>
<dd>spec_object</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="iotbx.ncs.ncs_preprocess.ncs_group_object.get_ncs_restraints_group_list">
<tt class="descname">get_ncs_restraints_group_list</tt><big>(</big><em>max_delta=10.0</em>, <em>raise_sorry=True</em><big>)</big><a class="headerlink" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.get_ncs_restraints_group_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a list of ncs_restraint_group objects</p>
<p>When using phil parameters or badly related copies, consider increasing
&#8220;max_delta&#8221; value</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>max_delta (float): maximum allowed deviation between copies coordinates
raise_sorry (bool): When True, raise Sorry if NCS copies don&#8217;t match</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="iotbx.ncs.ncs_preprocess.ncs_group_object.get_transform_records">
<tt class="descname">get_transform_records</tt><big>(</big><em>file_name=None</em>, <em>ncs_only=True</em>, <em>pdb_hierarchy=None</em>, <em>xrs=None</em>, <em>fmodel=None</em>, <em>crystal_symmetry=None</em>, <em>mtrix=None</em>, <em>biomt=None</em>, <em>write=False</em>, <em>log=None</em><big>)</big><a class="headerlink" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.get_transform_records" title="Permalink to this definition">¶</a></dt>
<dd><p>Write to a file or prints transformation records.
with or without PDB atoms and Cryst records.
If no pdb_hierarchy, xray structure or fmodel are provided, the function
will return only the MTRIX/BIOMT records</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">file_name: (str) output file name
ncs_only: (bool) When False, the comple ASU will be printed (applicable</p>
<blockquote>
<div>only with MTRIX records)</div></blockquote>
<p class="last">pdb_hierarchy: (pdb_hierarchy object)
xrs: (xray structure) for crystal symmetry
fmodel: (fmodel object)
crystal_symmetry: crystal symmetry records
mtrix: (bool) When True -&gt; write MTRIX records
biomt: (bool) When True -&gt; write BIOMT records
write: (bool) when False, will will not write to file or print</p>
</dd>
<dt>Return:</dt>
<dd>PDB string</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="iotbx.ncs.ncs_preprocess.ncs_group_object.look_and_combine_groups">
<tt class="descname">look_and_combine_groups</tt><big>(</big><em>gr_new</em>, <em>spec_group_list</em><big>)</big><a class="headerlink" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.look_and_combine_groups" title="Permalink to this definition">¶</a></dt>
<dd><p>In spec files groups of different masters and copies listed separately,
even if they have the same rotation/translation and can be combined.
This function combines them, updates the relevant object attributes and
returns True/False to indicate if group found</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>spec_group_list (list): selection string for each ncs copy in the group
gr_new (object): ncs group object</dd>
<dt>Returns:</dt>
<dd>found_same_group (bool): indicate if group found</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="iotbx.ncs.ncs_preprocess.ncs_group_object.make_chains_names">
<tt class="descname">make_chains_names</tt><big>(</big><em>transform_assignment</em>, <em>unique_chain_names</em><big>)</big><a class="headerlink" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.make_chains_names" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a dictionary names for the new NCS copies
keys: (str) chain_name + &#8216;_&#8217; + serial_num
values: (str) (one or two chr long)</p>
<p>Chain names might repeat themselves several times in a pdb file
We want copies of chains with the same name to still have the
same name after similar BIOMT/MTRIX transformation</p>
<p>Arguments:
transform_assignment : (list) transformation assignment order
unique_chain_names : (tuple) a set of unique chain names</p>
<p>Returns:
new_names : a dictionary. {&#8216;A_1&#8217;: &#8216;G&#8217;, &#8216;A_2&#8217;: &#8216;H&#8217;,....} map a chain
name and a transform number to a new chain name</p>
</dd></dl>

<dl class="method">
<dt id="iotbx.ncs.ncs_preprocess.ncs_group_object.preprocess_ncs_obj">
<tt class="descname">preprocess_ncs_obj</tt><big>(</big><em>pdb_hierarchy_inp=None</em>, <em>pdb_inp=None</em>, <em>hierarchy=None</em>, <em>transform_info=None</em>, <em>rotations=None</em>, <em>translations=None</em>, <em>ncs_phil_string=None</em>, <em>ncs_phil_groups=None</em>, <em>file_name=None</em>, <em>file_path=''</em>, <em>spec_file_str=''</em>, <em>spec_source_info=''</em>, <em>cif_string=''</em>, <em>quiet=True</em>, <em>spec_ncs_groups=None</em>, <em>pdb_string=None</em>, <em>use_minimal_master_ncs=True</em>, <em>exclude_selection='not (protein or nucleotide) or element H or element D'</em>, <em>max_rmsd=2.0</em>, <em>write_messages=False</em>, <em>process_similar_chains=True</em>, <em>min_percent=0.85</em>, <em>similarity_threshold=0.95</em>, <em>min_contig_length=10</em>, <em>log=None</em>, <em>check_atom_order=False</em>, <em>allow_different_size_res=True</em>, <em>exclude_misaligned_residues=True</em>, <em>match_radius=4.0</em>, <em>ignore_chains=None</em><big>)</big><a class="headerlink" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.preprocess_ncs_obj" title="Permalink to this definition">¶</a></dt>
<dd><p>Select method to build ncs_group_object</p>
<p>order of implementation:
1) rotations,translations
2) transform_info
3) ncs_phil_string
4) ncs_phil_groups
5) spec file
6) iotbx.pdb.hierarchy.input object</p>
</dd></dl>

<dl class="method">
<dt id="iotbx.ncs.ncs_preprocess.ncs_group_object.print_ncs_phil_param">
<tt class="descname">print_ncs_phil_param</tt><big>(</big><em>write=False</em>, <em>log=None</em><big>)</big><a class="headerlink" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.print_ncs_phil_param" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints NCS information in the phil parameters format
lines longer that 80 characters are folded</p>
<dl class="docutils">
<dt>Phil structure example:</dt>
<dd><dl class="first docutils">
<dt>ncs_group {</dt>
<dd>reference = &#8216;chain A&#8217;
selection = &#8216;chain C&#8217;
selection = &#8216;chain E&#8217;</dd>
</dl>
<p>}
ncs_group {</p>
<blockquote>
<div>reference = &#8216;chain B&#8217;
selection = &#8216;chain D&#8217;
selection = &#8216;chain F&#8217;</div></blockquote>
<p class="last">}</p>
</dd>
<dt>Args:</dt>
<dd>write (bool): when true, print to log
log : location of output, an open file or sys.stdout</dd>
<dt>Returns:</dt>
<dd>(str): NCS phil parameter string</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="iotbx.ncs.ncs_preprocess.ncs_group_object.process_pdb">
<tt class="descname">process_pdb</tt><big>(</big><em>transform_info</em><big>)</big><a class="headerlink" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.process_pdb" title="Permalink to this definition">¶</a></dt>
<dd><p>Process PDB Hierarchy object
Args:</p>
<blockquote>
<div>transform_info</div></blockquote>
<p>Remarks:
The information on a chain in a PDB file does not have to be continuous.
Every time the chain name changes in the pdb file, a new chain is added
to the model, even if the chain ID already exist. so there model.
chains() might contain several chains that have the same chain ID</p>
</dd></dl>

<dl class="method">
<dt id="iotbx.ncs.ncs_preprocess.ncs_group_object.set_common_res_dict">
<tt class="descname">set_common_res_dict</tt><big>(</big><big>)</big><a class="headerlink" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.set_common_res_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Build common residues list and related RMSD
for use when writing spec files list of common residues
for each chain - transform pair</p>
</dd></dl>

<dl class="method">
<dt id="iotbx.ncs.ncs_preprocess.ncs_group_object.show">
<tt class="descname">show</tt><big>(</big><em>format=None</em>, <em>verbose=False</em>, <em>prefix=''</em>, <em>header=True</em>, <em>log=None</em><big>)</big><a class="headerlink" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.show" title="Permalink to this definition">¶</a></dt>
<dd><p>Display NCS object</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first docutils">
<dt>format (str): &#8220;phil&#8221; <span class="classifier-delimiter">:</span> <span class="classifier">phil file representation</span></dt>
<dd>&#8220;spec&#8221; : spec representation out of NCS groups
&#8220;cctbx&#8221;: cctbx representation out of NCS groups
&#8220;restraints&#8221;  : .ncs (phenix refine) format
&#8220;constraints&#8221; : .ncs (phenix refine) format</dd>
<dt>verbose (bool): when True, will print selection strings, rotation and</dt>
<dd>translation info</dd>
<dt>prefix (str): a string to be added, padding the output, at the left of</dt>
<dd>each line</dd>
</dl>
<p class="last">header (bool): When True, include header
log: where to log the output, by default set to sys.stdout</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="iotbx.ncs.ncs_preprocess.ncs_group_object.show_chains_info">
<tt class="descname">show_chains_info</tt><big>(</big><em>prefix=''</em><big>)</big><a class="headerlink" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.show_chains_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns formatted string for print out, string containing chains IDs in a
table format, padded from the left with &#8220;prefix&#8221;</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first last docutils">
<dt>prefix (str): a string to be added, padding the output, at the left of</dt>
<dd>each line</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="iotbx.ncs.ncs_preprocess.ncs_group_object.show_ncs_headers">
<tt class="descname">show_ncs_headers</tt><big>(</big><em>prefix</em><big>)</big><a class="headerlink" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.show_ncs_headers" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a string of general info about NCS groups</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first last docutils">
<dt>prefix (str): a string to be added, padding the output, at the left of</dt>
<dd>each line</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="iotbx.ncs.ncs_preprocess.ncs_group_object.show_ncs_selections">
<tt class="descname">show_ncs_selections</tt><big>(</big><em>prefix=''</em><big>)</big><a class="headerlink" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.show_ncs_selections" title="Permalink to this definition">¶</a></dt>
<dd><p>Return NCS selection strings as a string, for printing</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first last docutils">
<dt>prefix (str): a string to be added, padding the output, at the left of</dt>
<dd>each line</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="iotbx.ncs.ncs_preprocess.ncs_group_object.show_phil_format">
<tt class="descname">show_phil_format</tt><big>(</big><em>prefix=''</em>, <em>header=True</em>, <em>group_prefix=''</em><big>)</big><a class="headerlink" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.show_phil_format" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a string of NCS groups phil parameters</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first docutils">
<dt>prefix (str): a string to be added, padding the output, at the left of</dt>
<dd>each line</dd>
</dl>
<p class="last">header (bool): When True, include header
group_prefix (str): prefix for the group only</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="iotbx.ncs.ncs_preprocess.ncs_group_object.show_search_parameters_values">
<tt class="descname">show_search_parameters_values</tt><big>(</big><em>prefix=''</em><big>)</big><a class="headerlink" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.show_search_parameters_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a string of search parameters values</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first last docutils">
<dt>prefix (str): a string to be added, padding the output, at the left of</dt>
<dd>each line</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="iotbx.ncs.ncs_preprocess.ncs_group_object.show_transform_info">
<tt class="descname">show_transform_info</tt><big>(</big><em>prefix=''</em><big>)</big><a class="headerlink" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.show_transform_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns formatted string for print out, string containing chains IDs in a
table format, padded from the left with &#8220;prefix&#8221;</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first last docutils">
<dt>prefix (str): a string to be added, padding the output, at the left of</dt>
<dd>each line</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="iotbx.ncs.ncs_preprocess.ncs_group_object.update_ncs_copies_chains_names">
<tt class="descname">update_ncs_copies_chains_names</tt><big>(</big><em>masters</em>, <em>copies</em>, <em>tr_id</em><big>)</big><a class="headerlink" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.update_ncs_copies_chains_names" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="iotbx.ncs.ncs_preprocess.ncs_group_object.update_tr_id_to_selection">
<tt class="descname">update_tr_id_to_selection</tt><big>(</big><em>masters</em>, <em>copies</em>, <em>tr_id</em><big>)</big><a class="headerlink" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.update_tr_id_to_selection" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Args:</dt>
<dd>masters: (str) selection of master ncs
copies: (str) selection of copy
tr_id: (str) string like &#8220;chain A_001&#8221; where 001 is the transform number</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="iotbx.ncs.ncs_preprocess.ncs_group_object.update_using_ncs_restraints_group_list">
<tt class="descname">update_using_ncs_restraints_group_list</tt><big>(</big><em>ncs_restraints_group_list</em><big>)</big><a class="headerlink" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.update_using_ncs_restraints_group_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Update ncs_group_object rotations and transformations.</p>
<p>Note that to insure proper assignment the ncs_restraints_group_list
should be produced using the get_ncs_restraints_group_list method</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>ncs_restraints_group_list: a list of ncs_restraint_group objects</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="iotbx.ncs.ncs_preprocess.ncs_group_object.validate_ncs_phil_groups">
<tt class="descname">validate_ncs_phil_groups</tt><big>(</big><em>pdb_hierarchy_inp</em>, <em>ncs_phil_groups</em><big>)</big><a class="headerlink" href="#iotbx.ncs.ncs_preprocess.ncs_group_object.validate_ncs_phil_groups" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="iotbx.ncs.ncs_preprocess.ncs_only">
<tt class="descclassname">iotbx.ncs.ncs_preprocess.</tt><tt class="descname">ncs_only</tt><big>(</big><em>transform_info</em><big>)</big><a class="headerlink" href="#iotbx.ncs.ncs_preprocess.ncs_only" title="Permalink to this definition">¶</a></dt>
<dd><p>Verify that all transforms are not present
(excluding the identity transform)</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>transform_info: (transformation object)</dd>
<dt>Returns:</dt>
<dd>(bool): True if all transforms are not present</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="iotbx.ncs.ncs_preprocess.rename_blank_chain_name">
<tt class="descclassname">iotbx.ncs.ncs_preprocess.</tt><tt class="descname">rename_blank_chain_name</tt><big>(</big><em>pdb_hierarchy_inp</em><big>)</big><a class="headerlink" href="#iotbx.ncs.ncs_preprocess.rename_blank_chain_name" title="Permalink to this definition">¶</a></dt>
<dd><p>when there is a blank chain name, rename it and mutate the
pdb_hierarchy_inp object</p>
</dd></dl>

<dl class="class">
<dt id="iotbx.ncs.ncs_preprocess.selections">
<em class="property">class </em><tt class="descclassname">iotbx.ncs.ncs_preprocess.</tt><tt class="descname">selections</tt><big>(</big><em>master_chain_id=''</em>, <em>copy_chain_id=''</em>, <em>master_sel=&lt;scitbx_array_family_flex_ext.size_t object at 0x7f7378c20940&gt;</em>, <em>copy_sel=&lt;scitbx_array_family_flex_ext.size_t object at 0x7f7378c20998&gt;</em>, <em>not_in_master=&lt;scitbx_array_family_flex_ext.size_t object at 0x7f7378c209f0&gt;</em>, <em>not_in_copy=&lt;scitbx_array_family_flex_ext.size_t object at 0x7f7378c20a48&gt;</em><big>)</big><a class="headerlink" href="#iotbx.ncs.ncs_preprocess.selections" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="http://docs.python.org/library/functions.html#object" title="(in Python v2.7)"><tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></a></p>
<p>object for grouping multiple selection information for master ncs and copy</p>
</dd></dl>

<dl class="function">
<dt id="iotbx.ncs.ncs_preprocess.sensible_unit_cell_volume">
<tt class="descclassname">iotbx.ncs.ncs_preprocess.</tt><tt class="descname">sensible_unit_cell_volume</tt><big>(</big><em>pdb_hierarchy_inp=None</em>, <em>pdb_inp=None</em>, <em>crystal_symmetry=None</em>, <em>transform_info=None</em>, <em>rotations=None</em><big>)</big><a class="headerlink" href="#iotbx.ncs.ncs_preprocess.sensible_unit_cell_volume" title="Permalink to this definition">¶</a></dt>
<dd><p>Rough evaluation if the number of atoms of all NCS copies can fit in
the unit cell.</p>
<p>Use this only when the pdb_hierarchy contains a single NCS copy</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>crystal_symmetry
pdb_hierarchy_inp
transform_info
rotations</dd>
<dt>Returns:</dt>
<dd>(bool): False indicates that the complete ASU does not fit in the unit cell</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="iotbx.ncs.ncs_preprocess.separate_selection_string">
<tt class="descclassname">iotbx.ncs.ncs_preprocess.</tt><tt class="descname">separate_selection_string</tt><big>(</big><em>s</em><big>)</big><a class="headerlink" href="#iotbx.ncs.ncs_preprocess.separate_selection_string" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="iotbx.ncs.ncs_preprocess.sort_dict_keys">
<tt class="descclassname">iotbx.ncs.ncs_preprocess.</tt><tt class="descname">sort_dict_keys</tt><big>(</big><em>d</em><big>)</big><a class="headerlink" href="#iotbx.ncs.ncs_preprocess.sort_dict_keys" title="Permalink to this definition">¶</a></dt>
<dd><p>sort dictionary d by values</p>
</dd></dl>

<dl class="function">
<dt id="iotbx.ncs.ncs_preprocess.uniqueness_test">
<tt class="descclassname">iotbx.ncs.ncs_preprocess.</tt><tt class="descname">uniqueness_test</tt><big>(</big><em>unique_selection_set</em>, <em>new_item</em><big>)</big><a class="headerlink" href="#iotbx.ncs.ncs_preprocess.uniqueness_test" title="Permalink to this definition">¶</a></dt>
<dd><p>When processing phil parameters. Insert new item to set, if not there,
raise an error if already in set</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>unique_selection_set: (set)
new_item: (str)</dd>
<dt>Returns:</dt>
<dd>unique_selection_set: updated set</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="iotbx.ncs.ncs_preprocess.update_ncs_group_map">
<tt class="descclassname">iotbx.ncs.ncs_preprocess.</tt><tt class="descname">update_ncs_group_map</tt><big>(</big><em>ncs_group_map</em>, <em>ncs_group_id</em>, <em>selection_ids</em>, <em>transform_id</em><big>)</big><a class="headerlink" href="#iotbx.ncs.ncs_preprocess.update_ncs_group_map" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Update ncs_group_map that maps a group ID to a list:</dt>
<dd>[master selection,list of objects containing transforms and copies
selections]</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="iotbx.ncs.ncs_preprocess.update_selection_ref">
<tt class="descclassname">iotbx.ncs.ncs_preprocess.</tt><tt class="descname">update_selection_ref</tt><big>(</big><em>selection_ref</em>, <em>new_selection</em><big>)</big><a class="headerlink" href="#iotbx.ncs.ncs_preprocess.update_selection_ref" title="Permalink to this definition">¶</a></dt>
<dd><p>Test for overlapping selection and then updates the selection_ref
with the new_selection</p>
<p>Both received and return arguments are flex.bool</p>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">iotbx.ncs package</a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-iotbx.ncs.ncs_preprocess">iotbx.ncs.ncs_preprocess module</a></li>
</ul>
</li>
</ul>

  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/iotbx/iotbx.ncs.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../index.html">CCTBX None documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2014, University of California.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>